---
sidebar_position: 1
title: 开始
---

import Cover from '@site/src/components/cover/main';

![](https://s2.loli.net/2022/10/23/qvgBXAlaGi4rPw7.jpg)

啊哈哈，在积攒了一段时间的想法后，我又来设计语言了

意识到了过于动态的话我现在没办法驾驭，所以还是常规一点好了

先命名为 IL 吧，indent lang 的缩写

顾名思义，它的写法和 python 类似，但是本质上是 lisp

我先说说我的思路

---

程序代码是什么？

由语法符，字面量，以及变量构成的文本，其中语法符包括操作符(内置)以及分隔符

分隔符将整个程序的元素构成一个抽象语法树，由嵌套的表达式，或者说列表构成

程序的运行就是对这个表达式的递归求值，当求值一个列表时，通过检查列表第一项是什么东东，决定后续的操作，这是 lisp 的特性

若第一项是操作符，那么运行硬编码的处理方法，否则作为函数运行，依次求值后面每一项，并作为参数列表传入函数

> 啥？你说为啥没有宏？
>
> hum，宏这玩意感觉和函数容易弄混，搞得语法不统一，并且只是把后面每一项加个 quote 的事情，目前来说可以由函数替代
>
> 虽然宏可以做到像是设计操作符那样炫酷的事情，不过现在还没考虑，到时候需要再加也行

程序需要有过程的抽象和具象，，也就是函数的定义和调用

当函数定义时，外层肯定是在运行的，但是函数内部不是，由于这东西是递归调用的，为了将运行与不运行的代码区分开，于是需要类似quote的东西，或者干脆由操作符处理，即使用操作符处理，行为也是类似quote的

quote一个列表，与包裹字符串类似，但是不一致

相似在于，它们都是可以包含自身的语法的

不同在于，字符串没有树结构，而quote列表后，需要将它解析成树，读取到每一个叶节点的元素，这点微妙的区别是需要特别注意的

也就是，读取，但是不求值，它依旧是有机会递归遍历到每一个元素的

既然和字符串类似，那么当然也可以采用格式化字符串的方式，让它在即使是读取的情况下，也**选择性**地求值。。。(这意味着需要加入转义，是实现上的细节)

这就是定义函数时，插入静态作用域变量的依据

---

整个程序是一个表达式，同时也是一个函数，可以有参数

虽然写代码时，默认最外层代码是运行状态的，但是本质上，它还是处于定义状态，只不过一般而言不需要区分，这一点也是需要注意的

IL 基于动态作用域，但是函数定义时可以同时获取动态，静态作用域的值并且设置参数——即便根本没有形参列表

所有的对象都可以放到表达式开头

函数是特殊的列表，说是特殊，也就是把`lambda`放到了列表的开头而已，可以像是一般的列表一样处理